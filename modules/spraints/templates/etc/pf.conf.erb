zig_if=<%= @zig_if %>
att_if=<%= @att_if %>
int_if=<%= @int_if %>

zig_ip=<%= @zig_ip %>
att_ip=<%= @att_ip %>

local_zig_ip=<%= @local_zig_ip %>
local_att_ip=<%= @local_att_ip %>
local_ip=<%= @int_ip %>

ext_ifs="{" $zig_if $att_if "}"
int_ifs=$int_if

table <martians> { 0.0.0.0/8 10.0.0.0/8 127.0.0.0/8 169.254.0.0/16     \
                   172.16.0.0/12 192.0.0.0/24 192.0.2.0/24 224.0.0.0/3 \
                   192.168.0.0/16 198.18.0.0/15 198.51.100.0/24        \
                   203.0.113.0/24 }

set block-policy drop
set skip on lo0

match in all scrub (no-df random-id max-mss 1440)
match out on $att_if inet from $int_net to any nat-to $att_if
match out on $zig_if inet from $int_net to any nat-to $zig_if

# todo - make this more lax re att_net and zig_net
block in quick on $ext_ifs from <martians> to any
block return out quick on $ext_ifs from any to <martians>

block all
pass out quick inet
pass in on $int_if inet
